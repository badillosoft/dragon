<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Dragon Test</title>
</head>
<body>
    <script src="../dragon.js"></script>
    <script src="../util.js"></script>

    <script>
        prototype("button", parent => {
            view(parent, `<button>hello</hello>`);
            const button = select(parent, "button");
            listen(button, "click", () => {
                dispatch(parent, "@click", button.textContent);
            });
            listen(parent, ":text", text => {
                console.log("Button: Texto", text, parent);
                button.textContent = text;
            });
        });

        prototype("a", parent => {
            listen(parent, ":createButton", text => {
                console.log("A: Creando Button", text, parent);
                const button = component("button", parent);
                dispatch(button, ":text", text);
                transmit(button, "@click", parent);
            });
        });

        prototype("b", parent => {
            view(parent, `<h1>B</h1>`);
            listen(parent, ":createA", text => {
                console.log("B: Creando A", text, parent);
                const componentA = component("a", parent);
                dispatch(componentA, ":createButton", text);
                transmit(componentA, "@click", parent);
            });
        });

        const componentB = component("b", document.body);

        dispatch(componentB, ":createA", "Hola1");
        dispatch(componentB, ":createA", "Hola2");

        listen(componentB, "@click", text => {
            alert(text);
            dispatch(componentB, ":createA", `${text} - ${uuid(4)}`);
        });
    </script>
</body>
</html>